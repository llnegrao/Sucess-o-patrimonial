<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Análise da Sucessão Patrimonial</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        body {
            font-family: 'Inter', -apple-system, sans-serif;
            margin: 0;
            padding: 20px;
            background: #0a0a0a;
            color: #e0e0e0;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            color: #fff;
            font-size: 2rem;
            margin-bottom: 30px;
            text-align: center;
            font-weight: 300;
            letter-spacing: -0.5px;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .card {
            background: #151515;
            border: 1px solid #2a2a2a;
            border-radius: 12px;
            padding: 20px;
        }
        .card h3 {
            margin: 0 0 15px 0;
            color: #fff;
            font-size: 1.1rem;
            font-weight: 500;
        }
        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #2a2a2a;
        }
        .metric:last-child {
            border-bottom: none;
        }
        .metric-label {
            color: #888;
            font-size: 0.9rem;
        }
        .metric-value {
            font-weight: 600;
            font-size: 1.1rem;
        }
        .positive {
            color: #4ade80;
        }
        .negative {
            color: #f87171;
        }
        .neutral {
            color: #60a5fa;
        }
        .warning {
            background: #1e1205;
            border: 1px solid #422006;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        .warning h4 {
            color: #fbbf24;
            margin: 0 0 10px 0;
            font-size: 0.95rem;
            font-weight: 600;
        }
        .warning p {
            color: #fef3c7;
            margin: 5px 0;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
        .flow-diagram {
            background: #151515;
            border: 1px solid #2a2a2a;
            border-radius: 12px;
            padding: 25px;
            margin: 30px 0;
        }
        .flow-step {
            display: flex;
            align-items: center;
            margin: 15px 0;
            padding: 15px;
            background: #1a1a1a;
            border-radius: 8px;
            border: 1px solid #2a2a2a;
        }
        .flow-step-number {
            width: 30px;
            height: 30px;
            background: #3b82f6;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }
        .flow-step-content {
            flex: 1;
        }
        .flow-step-title {
            font-weight: 600;
            color: #fff;
            margin-bottom: 5px;
        }
        .flow-step-desc {
            color: #888;
            font-size: 0.9rem;
        }
        .critical {
            background: #1a0505;
            border: 1px solid #450a0a;
        }
        .critical h4 {
            color: #ef4444;
        }
        .critical p {
            color: #fca5a5;
        }
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #2a2a2a;
        }
        th {
            background: #1a1a1a;
            color: #fff;
            font-weight: 600;
            font-size: 0.9rem;
        }
        td {
            color: #e0e0e0;
        }
        tr:hover {
            background: #1a1a1a;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Análise da Sucessão Patrimonial e Adiantamento</h1>
        
        <div class="grid">
            <div class="card">
                <h3>1. Distribuição Original da Previdência (Brasilprev)</h3>
                <div class="chart-container">
                    <canvas id="chart1"></canvas>
                </div>
            </div>
            
            <div class="card">
                <h3>2. Composição do Adiantamento de R$ 200.000,00 para Rose</h3>
                <div class="chart-container">
                    <canvas id="chart2"></canvas>
                </div>
            </div>
            
            <div class="card">
                <h3>3. Nova Distribuição da Previdência (Após Compensação)</h3>
                <div class="chart-container">
                    <canvas id="chart3"></canvas>
                </div>
            </div>
            
            <div class="card">
                <h3>4. Ganho Adicional na Brasilprev para os Outros 5 Herdeiros</h3>
                <div class="chart-container">
                    <canvas id="chart4"></canvas>
                </div>
            </div>
        </div>

        <div class="warning critical">
            <h4>⚠️ Pontos Críticos da Operação</h4>
            <p>• <strong>Liquidez assimétrica:</strong> Rose recebe R$ 200.000 em dinheiro HOJE. Os demais herdeiros recebem apenas R$ 12.452 em direitos futuros na Brasilprev.</p>
            <p>• <strong>Valor temporal do dinheiro ignorado:</strong> R$ 200.000 hoje não equivalem a R$ 200.000 futuros. A operação não considera juros ou correção monetária.</p>
            <p>• <strong>Risco de resgate:</strong> A compensação dos outros herdeiros depende da manutenção integral da Brasilprev até o resgate.</p>
            <p>• <strong>Tributação diferenciada:</strong> Rose pode ter vantagens fiscais ao antecipar o recebimento versus o resgate futuro da previdência.</p>
        </div>

        <div class="flow-diagram">
            <h3>Fluxo da Operação</h3>
            <div class="flow-step">
                <div class="flow-step-number">1</div>
                <div class="flow-step-content">
                    <div class="flow-step-title">Rose solicita R$ 200.000</div>
                    <div class="flow-step-desc">Necessidade imediata de capital para compra de apartamento</div>
                </div>
            </div>
            <div class="flow-step">
                <div class="flow-step-number">2</div>
                <div class="flow-step-content">
                    <div class="flow-step-title">Consumo total da cota na Casa Santos</div>
                    <div class="flow-step-desc">R$ 137.741 (100% de sua parte) + R$ 62.259 da Brasilprev</div>
                </div>
            </div>
            <div class="flow-step">
                <div class="flow-step-number">3</div>
                <div class="flow-step-content">
                    <div class="flow-step-title">Redistribuição na Brasilprev</div>
                    <div class="flow-step-desc">Rose fica com 9,03% (era 16,67%). Outros passam para 18,19% cada</div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>Análise Comparativa por Herdeiro</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Herdeiro</th>
                            <th>Cota Original Total</th>
                            <th>Valor Recebido/Antecipado</th>
                            <th>Saldo Remanescente</th>
                            <th>Diferença Real</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Rose</strong></td>
                            <td>R$ 273.630</td>
                            <td class="negative">R$ 200.000 (hoje)</td>
                            <td>R$ 73.630</td>
                            <td class="negative">-R$ 126.370 de direitos futuros</td>
                        </tr>
                        <tr>
                            <td>Outros (cada)</td>
                            <td>R$ 273.630</td>
                            <td class="positive">R$ 12.452 (futuro)</td>
                            <td>R$ 286.082</td>
                            <td class="positive">+R$ 12.452 em direitos futuros</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="warning">
            <h4>Questões Jurídicas e Fiscais</h4>
            <p>• A operação precisa ser formalizada adequadamente para evitar questionamentos futuros sobre doação ou adiantamento de legítima.</p>
            <p>• Verificar implicações do ITCMD (Imposto sobre Transmissão Causa Mortis e Doação) nesta antecipação.</p>
            <p>• Documentar expressamente o acordo entre todos os herdeiros para evitar litígios.</p>
            <p>• Considerar a necessidade de averbação ou registro formal da operação.</p>
        </div>
    </div>

    <script>
        // Chart 1 - Distribuição Original Brasilprev
        const ctx1 = document.getElementById('chart1').getContext('2d');
        new Chart(ctx1, {
            type: 'bar',
            data: {
                labels: ['Rose', 'Herdeiro 1', 'Herdeiro 2', 'Herdeiro 3', 'Herdeiro 4', 'Herdeiro 5'],
                datasets: [{
                    label: 'Valor (R$)',
                    data: [135889.29, 135889.29, 135889.29, 135889.29, 135889.29, 135889.29],
                    backgroundColor: 'rgba(96, 165, 250, 0.8)',
                    borderColor: 'rgba(96, 165, 250, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return 'R$ ' + context.parsed.y.toLocaleString('pt-BR', {minimumFractionDigits: 2});
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return 'R$ ' + (value/1000).toFixed(0) + 'k';
                            },
                            color: '#888'
                        },
                        grid: { color: '#2a2a2a' }
                    },
                    x: {
                        ticks: { color: '#888' },
                        grid: { display: false }
                    }
                }
            }
        });

        // Chart 2 - Composição do Adiantamento
        const ctx2 = document.getElementById('chart2').getContext('2d');
        new Chart(ctx2, {
            type: 'pie',
            data: {
                labels: ['Cota da Venda da Casa', 'Retirada da Brasilprev'],
                datasets: [{
                    data: [137741.17, 62258.83],
                    backgroundColor: [
                        'rgba(74, 222, 128, 0.8)',
                        'rgba(251, 191, 36, 0.8)'
                    ],
                    borderColor: [
                        'rgba(74, 222, 128, 1)',
                        'rgba(251, 191, 36, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: { color: '#e0e0e0' }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const label = context.label || '';
                                const value = context.parsed;
                                const percentage = ((value / 200000) * 100).toFixed(1);
                                return label + ': R$ ' + value.toLocaleString('pt-BR', {minimumFractionDigits: 2}) + ' (' + percentage + '%)';
                            }
                        }
                    }
                }
            }
        });

        // Chart 3 - Nova Distribuição Brasilprev
        const ctx3 = document.getElementById('chart3').getContext('2d');
        new Chart(ctx3, {
            type: 'bar',
            data: {
                labels: ['Rose', 'Herdeiro 1', 'Herdeiro 2', 'Herdeiro 3', 'Herdeiro 4', 'Herdeiro 5'],
                datasets: [{
                    label: 'Valor Ajustado (R$)',
                    data: [73630.46, 148341.06, 148341.06, 148341.06, 148341.06, 148341.06],
                    backgroundColor: function(context) {
                        return context.dataIndex === 0 ? 'rgba(248, 113, 113, 0.8)' : 'rgba(74, 222, 128, 0.8)';
                    },
                    borderColor: function(context) {
                        return context.dataIndex === 0 ? 'rgba(248, 113, 113, 1)' : 'rgba(74, 222, 128, 1)';
                    },
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return 'R$ ' + context.parsed.y.toLocaleString('pt-BR', {minimumFractionDigits: 2});
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return 'R$ ' + (value/1000).toFixed(0) + 'k';
                            },
                            color: '#888'
                        },
                        grid: { color: '#2a2a2a' }
                    },
                    x: {
                        ticks: { color: '#888' },
                        grid: { display: false }
                    }
                }
            }
        });

        // Chart 4 - Ganho Adicional
        const ctx4 = document.getElementById('chart4').getContext('2d');
        new Chart(ctx4, {
            type: 'bar',
            data: {
                labels: ['Herdeiro 1', 'Herdeiro 2', 'Herdeiro 3', 'Herdeiro 4', 'Herdeiro 5'],
                datasets: [{
                    label: 'Ganho (R$)',
                    data: [12451.77, 12451.77, 12451.77, 12451.77, 12451.77],
                    backgroundColor: 'rgba(74, 222, 128, 0.8)',
                    borderColor: 'rgba(74, 222, 128, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return 'R$ ' + context.parsed.y.toLocaleString('pt-BR', {minimumFractionDigits: 2});
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 16000,
                        ticks: {
                            callback: function(value) {
                                return 'R$ ' + (value/1000).toFixed(0) + 'k';
                            },
                            color: '#888'
                        },
                        grid: { color: '#2a2a2a' }
                    },
                    x: {
                        ticks: { color: '#888' },
                        grid: { display: false }
                    }
                }
            }
        });
    </script>
</body>
</html>